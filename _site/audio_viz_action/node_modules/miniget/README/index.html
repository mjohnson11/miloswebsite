<h1>node-miniget</h1>
<p>A small http(s) GET library with redirects, retries, reconnects, concatenating or streaming, and no dependencies. This keeps filesize small for potential browser use.</p>
<p><a href="http://travis-ci.org/fent/node-miniget"><img src="https://secure.travis-ci.org/fent/node-miniget.svg" alt="Build Status"></a>
<a href="https://david-dm.org/fent/node-miniget"><img src="https://david-dm.org/fent/node-miniget.svg" alt="Dependency Status"></a>
<a href="https://codecov.io/gh/fent/node-miniget"><img src="https://codecov.io/gh/fent/node-miniget/branch/master/graph/badge.svg" alt="codecov"></a></p>
<h1>Usage</h1>
<p>Concatenates a response</p>
<pre><code class="language-js">const miniget = require('miniget');

miniget('http://mywebsite.com', (err, body) =&gt; {
  console.log('webpage contents: ', body);
}));
</code></pre>
<p>Request can be streamed right away</p>
<pre><code class="language-js">miniget('http://api.mywebsite.com/v1/messages.json')
  .pipe(someWritableStream());
</code></pre>
<h1>API</h1>
<h3>miniget(url, [options], [callback(err, body)])</h3>
<p>Makes a GET request. <code>options</code> can have any properties from the <a href="https://nodejs.org/api/http.html#http_http_request_options_callback"><code>http.request()</code> function</a>, in addition to</p>
<ul>
<li><code>maxRedirects</code> - Default is <code>2</code>.</li>
<li><code>maxRetries</code> - Number of times to retry the request if there is a 500 or connection error. Default is <code>1</code>.</li>
<li><code>maxReconnects</code> - During a big download, if there is a disconnect, miniget can try to reconnect and continue the download where it left off. Defaults to <code>0</code>.</li>
<li><code>backoff</code> - An object with <code>inc</code> and <code>max</code> used to calculate how long to wait to retry a request. Defaults to <code>{ inc: 100, max: 10000 }</code>.</li>
<li><code>highWaterMark</code> - Amount of data to buffer when in stream mode.</li>
<li><code>transform</code> - Use this to add additional features. Called with the object that <code>http.get()</code> or <code>https.get()</code> would be called with. Must return a transformed object.</li>
<li><code>acceptEncoding</code> - An object with encoding name as the key, and the value as a function that returns a decoding stream.<pre><code class="language-js">acceptEncoding: { gzip: () =&gt; require('zlip').createGunzip(stream) }
</code></pre>
Given encodings will be added to the <code>Accept-Encoding</code> header, and the response will be decoded if the server responds with encoded content.</li>
</ul>
<p>If <code>callback</code> is given, will concatenate the response, and call <code>callback</code> with a possible error, and the response body.</p>
<p>Miniget returns a readable stream if <code>callback</code> is not given, errors will then be emitted on the stream. Returned stream also contains an <code>.abort()</code> method, and can emit the following events.</p>
<h4>Event: redirect</h4>
<ul>
<li><code>string</code> - URL redirected to.</li>
</ul>
<p>Emitted when the request was redirected with a redirection status code.</p>
<h4>Event: retry</h4>
<ul>
<li><code>number</code> - Number of retry.</li>
<li><code>Error</code> - Request or status code error.</li>
</ul>
<p>Emitted when the request fails, or the response has a status code &gt;= 500.</p>
<h4>Event: reconnect</h4>
<ul>
<li><code>number</code> - Number of reconnect.</li>
<li><code>Error</code> - Request or response error.</li>
</ul>
<p>Emitted when the request or response fails after download has started.</p>
<h1>Install</h1>
<pre><code>npm install miniget
</code></pre>
<h1>Tests</h1>
<p>Tests are written with <a href="https://mochajs.org">mocha</a></p>
<pre><code class="language-bash">npm test
</code></pre>
